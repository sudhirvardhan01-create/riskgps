"use strict";
const { LibraryQuestionnaire } = require("../models");
const { safeSeed } = require("../utils/seedHelper");

module.exports = {
  async up() {
    const questionnaires = [
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10001",
        question:
          "Does this asset have account use policies configured that enforce controls like login attempt lockouts, login time restrictions, etc.?",
        mitreControlId: ["M1036"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10002",
        question:
          "Is this asset integrated with your organization's identity provider? (i.e. AzureAD, Okta, Ping Identity, etc.)",
        mitreControlId: ["M1015"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10003",
        question:
          "Is an endpoint detection response tool implemented on this system? (i.e. Crowdstrike, CarbonBlack, SentinelOne, etc.)",
        mitreControlId: ["M1049", "M1040", "M1050", "M1044", "M1021"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10004",
        question:
          "Have employees been trained on security best practices for use of this asset and for detecting potential security vulnerabilities on this asset?",
        mitreControlId: ["M1013", "M1017"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Azure AD",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10005",
        question:
          "Is application isolation or sandboxing implemented for this asset?",
        mitreControlId: ["M1048"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10006",
        question:
          "Are vulnerability scans performed or manual audits to identify and remediate insecure configurations of this system?",
        mitreControlId: ["M1047", "M1016"],
      },
      {
        assetCategory: ["Windows", "macOS", "Linux", "Network Devices"],
        questionCode: "10007",
        question:
          "Are secure boot methods and integrity mechanisms implemented on this system?",
        mitreControlId: ["M1046"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10008",
        question:
          "Are application integrity or digital signatures that enforce verification of code before execution implemented on this system?",
        mitreControlId: ["M1045"],
      },
      {
        assetCategory: ["Windows", "macOS", "Linux", "Network Devices"],
        questionCode: "10009",
        question:
          "Are user credentials as well as service account and non-user account credentials for this asset stored securely to prevent unauthorized access?",
        mitreControlId: ["M1043"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10010",
        question:
          "Are backups of this system hardened with secure configurations and kept separate from the corporate network?",
        mitreControlId: ["M1053"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
        ],
        questionCode: "10011",
        question:
          "Are data leakage prevention (DLP) controls or tools for identification of sensitive information and restricting exfiltration implemented on this asset? (i.e. identification and restriction of PII, PCI, PHI, etc.)",
        mitreControlId: ["M1057"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10012",
        question:
          "Are access controls in place to implement the principle of least privilege on this asset (i.e. removing and denying unnecessary user access)? Specifically, are permissions limited for making sensitive configuration changes or installing third party connections (plugins, API integrations, etc.) on this asset?",
        mitreControlId: ["M1042", "M1039", "M1024", "M1052"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10013",
        question:
          "Is the data on this asset encrypted at rest with a strong encryption mechanism?",
        mitreControlId: ["M1041"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10014",
        question:
          "Are there application control or script blocking mechanisms in place to prevent execution of unauthorized code on this asset?",
        mitreControlId: ["M1038"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10015",
        question:
          "Is network traffic filtered for this system through a network firewall or at the host level through endpoint detection response tools (EDR) or a host firewall?",
        mitreControlId: ["M1037"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10016",
        question:
          "Is network access to this system limited to necessary access only through mechanisms lke network concentrators, RDP gateways, etc.?",
        mitreControlId: ["M1035"],
      },
      {
        assetCategory: ["Windows", "macOS", "Linux"],
        questionCode: "10017",
        question:
          "Is unapproved hardware blocked from being installed or used on this system? (i.e. USB devices, external drives)",
        mitreControlId: ["M1034"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "SaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10018",
        question:
          "Are controls in place to prevent software or other integrations to be installed on this system through measures like application controls or user permissions?",
        mitreControlId: ["M1033"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10019",
        question: "Is multifactor authentication (MFA) enforced on this asset?",
        mitreControlId: ["M1032"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10020",
        question:
          "Is network traffic monitored and blocked when necessary for this system through measures like firewall logs, packet capture, port scans, etc.?",
        mitreControlId: ["M1031", "DS0029", "DS0035"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10021",
        question:
          "Is this system on it's own network segment or virtual private cloud (VPC) to enforce network segmentation?",
        mitreControlId: ["M1030"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10022",
        question:
          "Has this system's configurations at the operating system level been hardened based on security best practices?",
        mitreControlId: ["M1028"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10023",
        question:
          "Is there a secure password policy enforced across all accounts for this asset?",
        mitreControlId: ["M1027"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10024",
        question:
          "Are privileged access management controls implemented for the creation, modification, use, and permissions of privileged accounts like administrator, super administrator, and root for this system?",
        mitreControlId: ["M1026"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
        ],
        questionCode: "10025",
        question:
          "Are privileged processes protected on this asset from attacks through measures like protected process light, anti-process injection defense, and process integrity controls?",
        mitreControlId: ["M1025"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10026",
        question:
          "Are remote security logs and sensitive files stored securely and monitored for potential intrusions for this asset?",
        mitreControlId: ["M1029"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10027",
        question:
          "Are user permissions set to limit access to directories and files to specific users and privileged accounts for this asset?",
        mitreControlId: ["M1022"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10028",
        question:
          "Is secure configuration management implemented on this system for any software configurations to mitigate any potential security risks?",
        mitreControlId: ["M1054"],
      },
      {
        assetCategory: ["Windows", "macOS", "Linux", "Network Devices"],
        questionCode: "10029",
        question:
          "Is web traffic monitored for this asset through unecnrypting SSL/TLS sessions?",
        mitreControlId: ["M1020"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Containers",
        ],
        questionCode: "10030",
        question:
          "Are threats for this asset monitored and tracked via threat intelligence sources tracking attack trends?",
        mitreControlId: ["M1019"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10031",
        question:
          "Does this asset have regular and scheduled software updates?",
        mitreControlId: ["M1051"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10032",
        question:
          "Are access provisioning processes in place for this asset to manage the creation, modification, use, and permissions changes of user accounts?",
        mitreControlId: ["M1018"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10033",
        question:
          "Is monitoring implemented for Active Directory (AD)/Identity Provider (IDP) requests and objects related to this asset?",
        mitreControlId: ["DS0026"],
      },
      {
        assetCategory: ["Windows", "macOS", "Linux", "Network Devices"],
        questionCode: "10034",
        question:
          "Are domain name system (DNS) requests (domain to IP address resolutions) monitored for this asset?",
        mitreControlId: ["DS0038"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10035",
        question:
          "Are application logs monitored for this asset using third party tools to collect logs, metrics, errors, alerts, etc.?",
        mitreControlId: ["DS0015"],
      },
      {
        assetCategory: [
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10036",
        question:
          "Are cloud services monitored for this asset (creation, deactivation, changes, etc.)?",
        mitreControlId: ["DS0025"],
      },
      {
        assetCategory: [
          "Office 365",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Containers",
        ],
        questionCode: "10037",
        question:
          "Is cloud storage monitored for this asset (opening, creation, removal, setting changes, etc.)?",
        mitreControlId: ["DS0010"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10038",
        question:
          "Are command executions monitored on this asset (i.e cmdlets, shell executions, etc.)?",
        mitreControlId: ["DS0017"],
      },
      {
        assetCategory: ["Windows", "macOS", "Linux", "IaaS", "Containers"],
        questionCode: "10039",
        question:
          "Are containers monitored for this asset (creation, activation/invocation, enumeration)?",
        mitreControlId: ["DS0032"],
      },
      {
        assetCategory: ["Windows", "macOS", "Linux", "Network Devices"],
        questionCode: "10040",
        question:
          "Are domains associated with this asset monitored for assignments and other metadata like WHOIS data?",
        mitreControlId: ["DS0038"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10041",
        question:
          "Are drives associated with this asset monitored (opening, construction, changes, etc.)?",
        mitreControlId: ["DS0016", "DS0027"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10042",
        question:
          "Are files associated with this asset monitored (creation, deletion, opening, changes to permissions)?",
        mitreControlId: ["DS0022"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Google Workspace",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10043",
        question:
          "Is firewall traffic and actions performed on firewalls for this asset monitored (disable, enumeration, metadata, rule modification)?",
        mitreControlId: ["DS0018"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Network Devices",
        ],
        questionCode: "10044",
        question:
          "Is firmware for this asset monitored for modifications including settings or data like Master Boot Record or Volume Boot Record?",
        mitreControlId: ["DS0001"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10045",
        question:
          "Is user group enumeration, metadata, and modification monitored on this asset?",
        mitreControlId: ["DS0036"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10046",
        question:
          "Is the host status monitored for this asset through host sensor health (metrics, errors, exceptions, etc.)?",
        mitreControlId: ["DS0013"],
      },
      {
        assetCategory: ["Windows", "macOS", "Linux", "IaaS", "Containers"],
        questionCode: "10047",
        question:
          "Are virtual machine images on this asset monitored (creation, deletion, modification, etc.)?",
        mitreControlId: ["DS0007"],
      },
      {
        assetCategory: ["Windows", "macOS", "Linux", "IaaS", "Containers"],
        questionCode: "10048",
        question:
          "Are virtual instances on this asset monitored (creation, deletion, modification, activation)?",
        mitreControlId: ["DS0030"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10049",
        question:
          "Are kernel module loads for this asset monitored (i.e. files that contain code to extended the running kernel of an OS)?",
        mitreControlId: ["DS0008"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10050",
        question:
          "Is logon activity including session create and metadata for this asset monitored?",
        mitreControlId: ["DS0028"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
        ],
        questionCode: "10051",
        question:
          "Are module loads into the memory of a process or program on this asset monitored?",
        mitreControlId: ["DS0011"],
      },
      {
        assetCategory: ["Windows", "macOS", "Linux"],
        questionCode: "10052",
        question:
          "Are named pipes on this asset monitored including name and creation process?",
        mitreControlId: ["DS0023"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "SaaS",
          "IaaS",
        ],
        questionCode: "10053",
        question:
          "Are network share accesses associated with this asset monitored?",
        mitreControlId: ["DS0033"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10054",
        question:
          "Are processes that call operating system functions/methods on this asset monitored?",
        mitreControlId: ["DS0009"],
      },
      {
        assetCategory: ["Containers"],
        questionCode: "10055",
        question:
          "Are pods for this asset monitored (creation, deletion, modification)?",
        mitreControlId: ["DS0014"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10056",
        question:
          "Are processes on this asset monitored (access, creation, metadata, modification, termination)?",
        mitreControlId: ["DS0009"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Google Workspace",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10057",
        question:
          "Are scheduled jobs on this asset monitored (creation, metadata, modification)?",
        mitreControlId: ["DS0003"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10058",
        question:
          "Are scripts executed via a code interpreter on this asset monitored?",
        mitreControlId: ["DS0012"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10059",
        question:
          "Are services on this asset monitored (creation, metadata, modification)?",
        mitreControlId: ["DS0019"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10060",
        question:
          "Are data snapshots on this asset monitored (creation, deletion, enumeration, metadata, modification)?",
        mitreControlId: ["DS0020"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Network Devices",
          "Containers",
        ],
        questionCode: "10061",
        question:
          "Is user account activity monitored on this asset including authentication, creation, deletion and modification?",
        mitreControlId: ["DS0002"],
      },
      {
        assetCategory: ["Windows", "Linux", "IaaS", "Containers"],
        questionCode: "10062",
        question:
          "Are cloud volumes monitored for this asset (creation, deletion, metadata, modification)?",
        mitreControlId: ["DS0034"],
      },
      {
        assetCategory: [
          "Windows",
          "macOS",
          "Linux",
          "Office 365",
          "Azure AD",
          "Google Workspace",
          "SaaS",
          "IaaS",
          "Containers",
        ],
        questionCode: "10063",
        question:
          "Is web credential usage and creation monitored for this asset?",
        mitreControlId: ["DS0006"],
      },
      {
        assetCategory: ["Windows", "Office 365", "Azure AD", "Network Devices"],
        questionCode: "10064",
        question:
          "Are registry keys on this asset monitored (access, creation, deletion, modification)?",
        mitreControlId: ["DS0024"],
      },
      {
        assetCategory: ["Windows", "Containers"],
        questionCode: "10065",
        question: "Are WMI object creation on this asset monitored?",
        mitreControlId: ["DS0005"],
      },
    ];
    await safeSeed(LibraryQuestionnaire, questionnaires, "question");
  },

  async down() {
    await LibraryQuestionnaire.destroy({ truncate: true, cascade: true });
  },
};
