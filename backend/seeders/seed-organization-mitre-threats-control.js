"use strict";
const { OrganizationThreat, Organization } = require("../models");
const { safeSeed } = require("../utils/seedHelper");

module.exports = {
  async up() {
    const now = new Date();
    const mitreThreatsControls = [
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1535",
        mitreTechniqueName: "Unused/Unsupported Cloud Regions",
        ciaMapping: ["C", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Creation",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor system logs to review instance activities occurring across all cloud environments and regions.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Monitor system logs to review instance activities occurring across all cloud environments and regions.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1535",
        mitreTechniqueName: "Unused/Unsupported Cloud Regions",
        ciaMapping: ["C", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Metadata",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor and consider configuring alerting to notify of activity in normally unused regions or if the number of instances active in a region goes above a certain threshold.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Monitor and consider configuring alerting to notify of activity in normally unused regions or if the number of instances active in a region goes above a certain threshold.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1535",
        mitreTechniqueName: "Unused/Unsupported Cloud Regions",
        ciaMapping: ["C", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "M1054",
        mitreControlName: "Software Configuration",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Cloud service providers may allow customers to deactivate unused regions.(Citation: CloudSploit - Unused AWS Regions)",
        controlPriority: 2,
        bluOceanControlDescription:
          "Cloud service providers may allow customers to deactivate unused regions.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1562",
        mitreTechniqueName: "Impair Defenses",
        ciaMapping: ["I", "A"],
        subTechniqueId: "T1562.007",
        subTechniqueName: "Disable or Modify Cloud Firewall",
        mitreControlId: "DS0018",
        mitreControlName: "Firewall Disable",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for changes in the status of the system firewall such as Windows Security Auditing events 5025 (The Windows firewall service has been stopped) and 5034 (The Windows firewall driver was stopped).",
        controlPriority: 3,
        bluOceanControlDescription:
          "Monitor for changes in the status of the system firewall",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1562",
        mitreTechniqueName: "Impair Defenses",
        ciaMapping: ["I", "A"],
        subTechniqueId: "T1562.007",
        subTechniqueName: "Disable or Modify Cloud Firewall",
        mitreControlId: "DS0018",
        mitreControlName: "Firewall Rule Modification",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor cloud logs for modification or creation of new security groups or firewall rules.",
        controlPriority: 3,
        bluOceanControlDescription:
          "Monitor cloud logs for modification or creation of new security groups or firewall rules.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1562",
        mitreTechniqueName: "Impair Defenses",
        ciaMapping: ["I", "A"],
        subTechniqueId: "T1562.007",
        subTechniqueName: "Disable or Modify Cloud Firewall",
        mitreControlId: "M1047",
        mitreControlName: "Audit",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Routinely check account role permissions to ensure only expected users and roles have permission to modify cloud firewalls.",
        controlPriority: 4,
        bluOceanControlDescription:
          "Routinely check account role permissions to ensure only expected users and roles have permission to modify cloud firewalls.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1562",
        mitreTechniqueName: "Impair Defenses",
        ciaMapping: ["I", "A"],
        subTechniqueId: "T1562.007",
        subTechniqueName: "Disable or Modify Cloud Firewall",
        mitreControlId: "M1018",
        mitreControlName: "User Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Ensure least privilege principles are applied to Identity and Access Management (IAM) security policies.(Citation: Expel IO Evil in AWS)",
        controlPriority: 5,
        bluOceanControlDescription:
          "Ensure least privilege principles are applied to Identity and Access Management (IAM) security policies.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1619",
        mitreTechniqueName: "Cloud Storage Object Discovery",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0010",
        mitreControlName: "Cloud Storage Access",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for unusual queries to the cloud provider's storage service. Activity originating from unexpected sources may indicate improper permissions are set that is allowing access to data. Additionally, detecting failed attempts by a user for a certain object, followed by escalation of privileges by the same user, and access to the same object may be an indication of suspicious activity.",
        controlPriority: 6,
        bluOceanControlDescription:
          "Monitor for unusual queries to the cloud provider's storage service. Activity originating from unexpected sources may indicate improper permissions are set that is allowing access to data. Additionally, detecting failed attempts by a user for a certain object, followed by escalation of privileges by the same user, and access to the same object may be an indication of suspicious activity.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1619",
        mitreTechniqueName: "Cloud Storage Object Discovery",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0010",
        mitreControlName: "Cloud Storage Enumeration",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor cloud logs for API calls used for file or object enumeration for unusual activity. System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Collection and Exfiltration, based on the information obtained.",
        controlPriority: 6,
        bluOceanControlDescription:
          "Monitor cloud logs for API calls used for file or object enumeration for unusual activity. System and network discovery techniques normally occur throughout an operation as an adversary learns the environment.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1619",
        mitreTechniqueName: "Cloud Storage Object Discovery",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "M1018",
        mitreControlName: "User Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Restrict granting of permissions related to listing objects in cloud storage to necessary accounts.",
        controlPriority: 5,
        bluOceanControlDescription:
          "Restrict granting of permissions related to listing objects in cloud storage to necessary accounts.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1580",
        mitreTechniqueName: "Cloud Infrastructure Discovery",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0010",
        mitreControlName: "Cloud Storage Enumeration",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor cloud logs for API calls and other potentially unusual activity related to cloud data object storage enumeration. Discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Collection and Exfiltration, based on the information obtained.",
        controlPriority: 6,
        bluOceanControlDescription:
          "Monitor cloud logs for API calls and other potentially unusual activity related to cloud data object storage enumeration.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1580",
        mitreTechniqueName: "Cloud Infrastructure Discovery",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Enumeration",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor cloud logs for API calls and other potentially unusual activity related to cloud instance enumeration. Discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Collection and Exfiltration, based on the information obtained.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Monitor cloud logs for API calls and other potentially unusual activity related to cloud instance enumeration.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1580",
        mitreTechniqueName: "Cloud Infrastructure Discovery",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0020",
        mitreControlName: "Snapshot Enumeration",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor cloud logs for API calls and other potentially unusual activity related to snapshot enumeration. Discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Collection and Exfiltration, based on the information obtained.",
        controlPriority: 7,
        bluOceanControlDescription:
          "Monitor cloud logs for API calls and other potentially unusual activity related to snapshot enumeration.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1580",
        mitreTechniqueName: "Cloud Infrastructure Discovery",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0034",
        mitreControlName: "Volume Enumeration",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor cloud logs for API calls and other potentially unusual activity related to block object storage enumeration. Discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Collection and Exfiltration, based on the information obtained.",
        controlPriority: 8,
        bluOceanControlDescription:
          "Monitor cloud logs for API calls and other potentially unusual activity related to block object storage enumeration.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1580",
        mitreTechniqueName: "Cloud Infrastructure Discovery",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "M1018",
        mitreControlName: "User Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Limit permissions to discover cloud infrastructure in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.",
        controlPriority: 5,
        bluOceanControlDescription:
          "Limit permissions to discover cloud infrastructure in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1555",
        mitreTechniqueName: "Credentials from Password Stores",
        ciaMapping: ["C"],
        subTechniqueId: "T1555.006",
        subTechniqueName: "Cloud Secrets Management Stores",
        mitreControlId: "DS0025",
        mitreControlName: "Cloud Service Enumeration",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for API calls and CLI commands that attempt to enumerate and fetch credential material from the secrets manager, such as `get-secret-value` in AWS, `gcloud secrets describe` in GCP, and `az key vault secret show` in Azure. Alert on any suspicious usages of these commands, such as an account or service generating an unusually high number of secret requests.",
        controlPriority: 9,
        bluOceanControlDescription:
          "Monitor for API calls and CLI commands that attempt to enumerate and fetch credential material from the secrets manager. Alert on any suspicious usages of these commands, such as an account or service generating an unusually high number of secret requests.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1555",
        mitreTechniqueName: "Credentials from Password Stores",
        ciaMapping: ["C"],
        subTechniqueId: "T1555.006",
        subTechniqueName: "Cloud Secrets Management Stores",
        mitreControlId: "M1026",
        mitreControlName: "Privileged Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Limit the number of cloud accounts and services with permission to query the secrets manager to only those required. Ensure that accounts and services with permissions to query the secrets manager only have access to the secrets they require.",
        controlPriority: 10,
        bluOceanControlDescription:
          "Limit the number of cloud accounts and services with permission to query the secrets manager to only those required. Ensure that accounts and services with permissions to query the secrets manager only have access to the secrets they require.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1552",
        mitreTechniqueName: "Credentials from Password Stores",
        ciaMapping: ["C"],
        subTechniqueId: "T1552.005",
        subTechniqueName: "Cloud Instance Metadata API",
        mitreControlId: "DS0002",
        mitreControlName: "User Account Authentication",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "It may be possible to detect adversary use of credentials they have obtained such as in [Valid Accounts](https://attack.mitre.org/techniques/T1078).",
        controlPriority: 1,
        bluOceanControlDescription:
          "It may be possible to detect adversary use of credentials they have obtained such as in valid accounts",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1552",
        mitreTechniqueName: "Credentials from Password Stores",
        ciaMapping: ["C"],
        subTechniqueId: "T1552.005",
        subTechniqueName: "Cloud Instance Metadata API",
        mitreControlId: "M1042",
        mitreControlName: "Disable or Remove Feature or Program",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Disable unnecessary metadata services and restrict or disable insecure versions of metadata services that are in use to prevent adversary access.(Citation: Amazon AWS IMDS V2)",
        controlPriority: 2,
        bluOceanControlDescription:
          "Disable unnecessary metadata services and restrict or disable insecure versions of metadata services that are in use to prevent adversary access.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1552",
        mitreTechniqueName: "Credentials from Password Stores",
        ciaMapping: ["C"],
        subTechniqueId: "T1552.005",
        subTechniqueName: "Cloud Instance Metadata API",
        mitreControlId: "M1037",
        mitreControlName: "Filter Network Traffic",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Limit access to the Instance Metadata API. A properly configured Web Application Firewall (WAF) may help prevent external adversaries from exploiting Server-side Request Forgery (SSRF) attacks that allow access to the Cloud Instance Metadata API.(Citation: RedLock Instance Metadata API 2018)",
        controlPriority: 3,
        bluOceanControlDescription:
          "Limit access to the Instance Metadata API. A properly configured Web Application Firewall (WAF) may help prevent external adversaries from exploiting Server-side Request Forgery (SSRF) attacks",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1552",
        mitreTechniqueName: "Credentials from Password Stores",
        ciaMapping: ["C"],
        subTechniqueId: "T1552.005",
        subTechniqueName: "Cloud Instance Metadata API",
        mitreControlId: "M1035",
        mitreControlName: "Limit Access to Resource Over Network",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Limit access to the Instance Metadata API using a host-based firewall such as iptables.",
        controlPriority: 4,
        bluOceanControlDescription:
          "Limit access to the Instance Metadata API using a host-based firewall such as iptables.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0025",
        mitreControlName: "Cloud Service Metadata",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for quota increases across all regions, especially multiple quota increases in a short period of time or quota increases in unused regions. Monitor for changes to tenant-level settings such as subscriptions and enabled regions.(Citation: Microsoft Cryptojacking 2023)",
        controlPriority: 9,
        bluOceanControlDescription:
          "Monitor for quota increases across all regions, especially multiple quota increases in a short period of time or quota increases in unused regions. Monitor for changes to tenant-level settings such as subscriptions and enabled regions.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Creation",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "The creation of a new instance or VM is a common part of operations within many cloud environments. Events should then not be viewed in isolation, but as part of a chain of behavior that could lead to other activities. For example, the creation of an instance by a new user account or the unexpected creation of one or more snapshots followed by the creation of an instance may indicate suspicious activity.\n In AWS, CloudTrail logs capture the creation of an instance in the RunInstances event, and in Azure the creation of a VM may be captured in Azure activity logs.(Citation: AWS CloudTrail Search) (Citation: Azure Activity Logs) Google's Admin Activity audit logs within their Cloud Audit logs can be used to detect the usage of gcloud compute instances create to create a VM.(Citation: Cloud Audit Logs)",
        controlPriority: 1,
        bluOceanControlDescription:
          "The creation of a new instance or VM is a common part of operations within many cloud environments. Events should then not be viewed in isolation, but as part of a chain of behavior that could lead to other activities.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Deletion",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "The deletion of a new instance or virtual machine is a common part of operations within many cloud environments. Events should then not be viewed in isolation, but as part of a chain of behavior that could lead to other activities. For example, detecting a sequence of events such as the creation of an instance, mounting of a snapshot to that instance, and deletion of that instance by a new user account may indicate suspicious activity.\n \n In AWS, CloudTrail logs capture the deletion of an instance in the TerminateInstances event, and in Azure the deletion of a VM may be captured in Azure activity logs.(Citation: AWS CloudTrail Search) (Citation: Azure Activity Logs) Google's Admin Activity audit logs within their Cloud Audit logs can be used to detect the usage of gcloud compute instances delete to delete a VM.(Citation: Cloud Audit Logs)",
        controlPriority: 1,
        bluOceanControlDescription:
          "The deletion of a new instance or virtual machine is a common part of operations within many cloud environments. Events should then not be viewed in isolation, but as part of a chain of behavior that could lead to other activities.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Metadata",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Periodically baseline instances to identify malicious modifications or additions.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Periodically baseline instances to identify malicious modifications or additions.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Modification",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Establish centralized logging of instance activity, which can be used to monitor and review system events even after reverting to a snapshot, rolling back changes, or changing persistence/type of storage. Monitor specifically for events related to snapshots and rollbacks and VM configuration changes, that are occurring outside of normal activity. To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Establish centralized logging of instance activity, which can be used to monitor and review system events even after reverting to a snapshot, rolling back changes, or changing persistence/type of storage. Monitor specifically for events related to snapshots and rollbacks and VM configuration changes, that are occurring outside of normal activity.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Start",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Establish centralized logging of instance activity, which can be used to monitor and review system events even after reverting to a snapshot, rolling back changes, or changing persistence/type of storage. Monitor specifically for events related to activation of instances that are occurring outside of normal activity/planned operations. To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Establish centralized logging of instance activity, which can be used to monitor and review system events even after reverting to a snapshot, rolling back changes, or changing persistence/type of storage. Monitor specifically for events related to activation of instances that are occurring outside of normal activity/planned operations.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Stop",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Establish centralized logging of instance activity, which can be used to monitor and review system events even after reverting to a snapshot, rolling back changes, or changing persistence/type of storage. Monitor specifically for events related to deactivation of instances that are occurring outside of planned operations. To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Establish centralized logging of instance activity, which can be used to monitor and review system events even after reverting to a snapshot, rolling back changes, or changing persistence/type of storage. Monitor specifically for events related to deactivation of instances that are occurring outside of planned operations.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0020",
        mitreControlName: "Snapshot Creation",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Establish centralized logging for the activity of cloud compute infrastructure components. Monitor for suspicious sequences of events, such as the creation of multiple snapshots within a short period of time. To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
        controlPriority: 7,
        bluOceanControlDescription:
          "Establish centralized logging for the activity of cloud compute infrastructure components. Monitor for suspicious sequences of events, such as the creation of multiple snapshots within a short period of time.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0020",
        mitreControlName: "Snapshot Deletion",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Establish centralized logging for the activity of cloud compute infrastructure components. Monitor for suspicious sequences of events, such as the deletion of multiple snapshots within a short period of time. To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
        controlPriority: 7,
        bluOceanControlDescription:
          "Establish centralized logging for the activity of cloud compute infrastructure components. Monitor for suspicious sequences of events, such as the deletion of multiple snapshots within a short period of time",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0020",
        mitreControlName: "Snapshot Metadata",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Periodically baseline snapshots to identify malicious modifications or additions.",
        controlPriority: 7,
        bluOceanControlDescription:
          "Periodically baseline snapshots to identify malicious modifications or additions.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0020",
        mitreControlName: "Snapshot Modification",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Establish centralized logging for the activity of cloud compute infrastructure components. Monitor for suspicious sequences of events, such as the mounting of a snapshot to a new instance by a new or unexpected user. To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
        controlPriority: 7,
        bluOceanControlDescription:
          "Establish centralized logging for the activity of cloud compute infrastructure components. Monitor for suspicious sequences of events, such as the mounting of a snapshot to a new instance by a new or unexpected user.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0034",
        mitreControlName: "Volume Creation",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for the unexpected creation or presence of cloud block storage volumes . To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
        controlPriority: 8,
        bluOceanControlDescription:
          "Monitor for the unexpected creation or presence of cloud block storage volumes",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0034",
        mitreControlName: "Volume Deletion",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for the unexpected deletion or absence of cloud block storage volumes . To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
        controlPriority: 8,
        bluOceanControlDescription:
          "Monitor for the unexpected deletion or absence of cloud block storage volumes",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0034",
        mitreControlName: "Volume Metadata",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Periodically baseline cloud block storage volumes to identify malicious modifications or additions.",
        controlPriority: 8,
        bluOceanControlDescription:
          "Periodically baseline cloud block storage volumes to identify malicious modifications or additions.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0034",
        mitreControlName: "Volume Modification",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for the unexpected changes to cloud block storage volumes . To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
        controlPriority: 8,
        bluOceanControlDescription:
          "Monitor for the unexpected changes to cloud block storage volumes",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "M1047",
        mitreControlName: "Audit",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Routinely monitor user permissions to ensure only the expected users have the capability to modify cloud compute infrastructure components.",
        controlPriority: 4,
        bluOceanControlDescription:
          "Routinely monitor user permissions to ensure only the expected users have the capability to modify cloud compute infrastructure components.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "M1018",
        mitreControlName: "User Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Limit permissions for creating, deleting, and otherwise altering compute components in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.(Citation: Mandiant M-Trends 2020)",
        controlPriority: 5,
        bluOceanControlDescription:
          "Limit permissions for creating, deleting, and otherwise altering compute components in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.001",
        subTechniqueName: "Create Snapshot",
        mitreControlId: "DS0020",
        mitreControlName: "Snapshot Creation",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "The creation of a snapshot is a common part of operations within many cloud environments. Events should then not be viewed in isolation, but as part of a chain of behavior that could lead to other activities such as the creation of one or more snapshots and the restoration of these snapshots by a new user account.\n In AWS, CloudTrail logs capture the creation of snapshots and all API calls for AWS Backup as events. Using the information collected by CloudTrail, you can determine the request that was made, the IP address from which the request was made, which user made the request, when it was made, and additional details.(Citation: AWS Cloud Trail Backup API)\n In Azure, the creation of a snapshot may be captured in Azure activity logs. Backup restoration events can also be detected through Azure Monitor Log Data by creating a custom alert for completed restore jobs.(Citation: Azure - Monitor Logs)\n Google's Admin Activity audit logs within their Cloud Audit logs can be used to detect the usage of the gcloud compute instances create command to create a new VM disk from a snapshot.(Citation: Cloud Audit Logs) It is also possible to detect the usage of the GCP API with the <code>sourceSnapshot</code> parameter pointed to <code>global/snapshots/[BOOT_SNAPSHOT_NAME]</code>.(Citation: GCP - Creating and Starting a VM)",
        controlPriority: 7,
        bluOceanControlDescription:
          "The creation of a snapshot is a common part of operations within many cloud environments. Events should then not be viewed in isolation, but as part of a chain of behavior that could lead to other activities such as the creation of one or more snapshots and the restoration of these snapshots by a new user account.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.001",
        subTechniqueName: "Create Snapshot",
        mitreControlId: "DS0020",
        mitreControlName: "Snapshot Metadata",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Periodically baseline snapshots to identify malicious modifications or additions.",
        controlPriority: 7,
        bluOceanControlDescription:
          "Periodically baseline snapshots to identify malicious modifications or additions.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.001",
        subTechniqueName: "Create Snapshot",
        mitreControlId: "M1047",
        mitreControlName: "Audit",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Routinely check user permissions to ensure only the expected users have the capability to create snapshots and backups.",
        controlPriority: 4,
        bluOceanControlDescription:
          "Routinely check user permissions to ensure only the expected users have the capability to create snapshots and backups.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.001",
        subTechniqueName: "Create Snapshot",
        mitreControlId: "M1018",
        mitreControlName: "User Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Limit permissions for creating snapshots or backups in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.(Citation: Mandiant M-Trends 2020)",
        controlPriority: 5,
        bluOceanControlDescription:
          "Limit permissions for creating snapshots or backups in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.002",
        subTechniqueName: "Create Cloud Instance",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Creation",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "The creation of a new instance or VM is a common part of operations within many cloud environments. Events should then not be viewed in isolation, but as part of a chain of behavior that could lead to other activities. For example, the creation of an instance by a new user account or the unexpected creation of one or more snapshots followed by the creation of an instance may indicate suspicious activity.\n In AWS, CloudTrail logs capture the creation of an instance in the RunInstances event, and in Azure the creation of a VM may be captured in Azure activity logs.(Citation: AWS CloudTrail Search) (Citation: Azure Activity Logs) Google's Admin Activity audit logs within their Cloud Audit logs can be used to detect the usage of gcloud compute instances create to create a VM.(Citation: Cloud Audit Logs)",
        controlPriority: 1,
        bluOceanControlDescription:
          "The creation of a new instance or VM is a common part of operations within many cloud environments. Events should then not be viewed in isolation, but as part of a chain of behavior that could lead to other activities.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.002",
        subTechniqueName: "Create Cloud Instance",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Metadata",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Periodically baseline instances to identify malicious modifications or additions.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Periodically baseline instances to identify malicious modifications or additions.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.002",
        subTechniqueName: "Create Cloud Instance",
        mitreControlId: "M1047",
        mitreControlName: "Audit",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Routinely check user permissions to ensure only the expected users have the capability to create new instances.",
        controlPriority: 4,
        bluOceanControlDescription:
          "Routinely check user permissions to ensure only the expected users have the capability to create new instances.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.002",
        subTechniqueName: "Create Cloud Instance",
        mitreControlId: "M1018",
        mitreControlName: "User Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Limit permissions for creating new instances in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.(Citation: Mandiant M-Trends 2020)",
        controlPriority: 5,
        bluOceanControlDescription:
          "Limit permissions for creating new instances in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.(",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.003",
        subTechniqueName: "Delete Cloud Instance",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Deletion",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "The deletion of a new instance or virtual machine is a common part of operations within many cloud environments. Events should then not be viewed in isolation, but as part of a chain of behavior that could lead to other activities. For example, detecting a sequence of events such as the creation of an instance, mounting of a snapshot to that instance, and deletion of that instance by a new user account may indicate suspicious activity.\n \n In AWS, CloudTrail logs capture the deletion of an instance in the TerminateInstances event, and in Azure the deletion of a VM may be captured in Azure activity logs.(Citation: AWS CloudTrail Search) (Citation: Azure Activity Logs) Google's Admin Activity audit logs within their Cloud Audit logs can be used to detect the usage of gcloud compute instances delete to delete a VM.(Citation: Cloud Audit Logs)",
        controlPriority: 1,
        bluOceanControlDescription:
          "The deletion of a new instance or virtual machine is a common part of operations within many cloud environments. Events should then not be viewed in isolation, but as part of a chain of behavior that could lead to other activities.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.003",
        subTechniqueName: "Delete Cloud Instance",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Metadata",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Periodically baseline instances to identify malicious modifications or additions.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Periodically baseline instances to identify malicious modifications or additions.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.003",
        subTechniqueName: "Delete Cloud Instance",
        mitreControlId: "M1047",
        mitreControlName: "Audit",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Routinely check user permissions to ensure only the expected users have the capability to delete new instances.",
        controlPriority: 4,
        bluOceanControlDescription:
          "Routinely check user permissions to ensure only the expected users have the capability to delete new instances.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.003",
        subTechniqueName: "Delete Cloud Instance",
        mitreControlId: "M1018",
        mitreControlName: "User Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Limit permissions for deleting new instances in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.(Citation: Mandiant M-Trends 2020)",
        controlPriority: 5,
        bluOceanControlDescription:
          "Limit permissions for deleting new instances in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.004",
        subTechniqueName: "Revert Cloud Instance",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Metadata",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Periodically baseline instances to identify malicious modifications or additions.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Periodically baseline instances to identify malicious modifications or additions.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.004",
        subTechniqueName: "Revert Cloud Instance",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Modification",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Establish centralized logging of instance activity, which can be used to monitor and review system events even after reverting to a snapshot, rolling back changes, or changing persistence/type of storage. Monitor specifically for events related to snapshots and rollbacks and VM configuration changes, that are occurring outside of normal activity. To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Establish centralized logging of instance activity, which can be used to monitor and review system events even after reverting to a snapshot, rolling back changes, or changing persistence/type of storage. Monitor specifically for events related to snapshots and rollbacks and VM configuration changes, that are occurring outside of normal activity.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.004",
        subTechniqueName: "Revert Cloud Instance",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Start",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Establish centralized logging of instance activity, which can be used to monitor and review system events even after reverting to a snapshot, rolling back changes, or changing persistence/type of storage. Monitor specifically for events related to activation of instances that are occurring outside of normal activity/planned operations. To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Establish centralized logging of instance activity, which can be used to monitor and review system events even after reverting to a snapshot, rolling back changes, or changing persistence/type of storage. Monitor specifically for events related to activation of instances that are occurring outside of normal activity/planned operations.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.004",
        subTechniqueName: "Revert Cloud Instance",
        mitreControlId: "DS0030",
        mitreControlName: "Instance Stop",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Establish centralized logging of instance activity, which can be used to monitor and review system events even after reverting to a snapshot, rolling back changes, or changing persistence/type of storage. Monitor specifically for events related to deactivation of instances that are occurring outside of planned operations. To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Establish centralized logging of instance activity, which can be used to monitor and review system events even after reverting to a snapshot, rolling back changes, or changing persistence/type of storage. Monitor specifically for events related to deactivation of instances that are occurring outside of planned operations.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.005",
        subTechniqueName: "Modify Cloud Compute Configurations",
        mitreControlId: "DS0025",
        mitreControlName: "Cloud Service Modification",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for quota increases across all regions, especially multiple quota increases in a short period of time or quota increases in unused regions. Monitor for changes to tenant-level settings such as subscriptions and enabled regions.(Citation: Microsoft Cryptojacking 2023)",
        controlPriority: 9,
        bluOceanControlDescription:
          "Monitor for quota increases across all regions, especially multiple quota increases in a short period of time or quota increases in unused regions. Monitor for changes to tenant-level settings such as subscriptions and enabled regions.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.005",
        subTechniqueName: "Modify Cloud Compute Configurations",
        mitreControlId: "M1047",
        mitreControlName: "Audit",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Routinely monitor user permissions to ensure only the expected users have the capability to request quota adjustments or modify tenant-level compute settings.",
        controlPriority: 4,
        bluOceanControlDescription:
          "Routinely monitor user permissions to ensure only the expected users have the capability to request quota adjustments or modify tenant-level compute settings.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1578",
        mitreTechniqueName: "Modify Cloud Compute Infrastructure",
        ciaMapping: ["C", "I", "A"],
        subTechniqueId: "T1578.005",
        subTechniqueName: "Modify Cloud Compute Configurations",
        mitreControlId: "M1018",
        mitreControlName: "User Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Limit permissions to request quotas adjustments or modify tenant-level compute setting to only those required.",
        controlPriority: 5,
        bluOceanControlDescription:
          "Limit permissions to request quotas adjustments or modify tenant-level compute setting to only those required.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1651",
        mitreTechniqueName: "Cloud Administration Command",
        ciaMapping: ["C", "I"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0017",
        mitreControlName: "Command Execution",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor commands and scripts executed on virtual machines. In Azure, usage of Azure RunCommand can be identified via the Azure Activity Logs, and additional details on the result of executed jobs are available in the `C:\\Packages\\Plugins\\Microsoft.CPlat.Core.RunCommandWindows` directory on Windows virtual machines.(Citation: Mandiant Azure Run Command 2021)",
        controlPriority: 5,
        bluOceanControlDescription:
          "Monitor commands and scripts executed on virtual machines.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1651",
        mitreTechniqueName: "Cloud Administration Command",
        ciaMapping: ["C", "I"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0009",
        mitreControlName: "Process Creation",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor virtual machines for the creation of processes associated with cloud virtual machine agents. In Windows-based Azure machines, monitor for the WindowsAzureGuestAgent.exe process.(Citation: Mandiant Azure Run Command 2021)",
        controlPriority: 6,
        bluOceanControlDescription:
          "Monitor virtual machines for the creation of processes associated with cloud virtual machine agents.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1651",
        mitreTechniqueName: "Cloud Administration Command",
        ciaMapping: ["C", "I"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0012",
        mitreControlName: "Script Execution",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor commands and scripts executed on virtual machines. In Azure, usage of Azure RunCommand can be identified via the Azure Activity Logs, and additional details on the result of executed jobs are available in the `C:\\Packages\\Plugins\\Microsoft.CPlat.Core.RunCommandWindows` directory on Windows virtual machines.(Citation: Mandiant Azure Run Command 2021)",
        controlPriority: 7,
        bluOceanControlDescription:
          "Monitor commands and scripts executed on virtual machines.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1651",
        mitreTechniqueName: "Cloud Administration Command",
        ciaMapping: ["C", "I"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "M1026",
        mitreControlName: "Privileged Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Limit the number of cloud accounts with permissions to remotely execute commands on virtual machines, and ensure that these are not used for day-to-day operations. In Azure, limit the number of accounts with the roles Azure Virtual Machine Contributer and above, and consider using temporary Just-in-Time (JIT) roles to avoid permanently assigning privileged access to virtual machines.(Citation: Mandiant Azure Run Command 2021)",
        controlPriority: 10,
        bluOceanControlDescription:
          "Limit the number of cloud accounts with permissions to remotely execute commands on virtual machines, and ensure that these are not used for day-to-day operations.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1021",
        mitreTechniqueName: "Remote Services",
        ciaMapping: ["C"],
        subTechniqueId: "T1021.008",
        subTechniqueName: "Direct Cloud VM Connections",
        mitreControlId: "DS0028",
        mitreControlName: "Logon Session Creation",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor cloud audit logs and host logs for logon session events. These can be found in CloudTrail, Unified Audit Logs, Windows Event Logs and `/var/log/auth.log` or `/var/log/secure` for Linux systems.",
        controlPriority: 8,
        bluOceanControlDescription:
          "Monitor cloud audit logs and host logs for logon session events. These can be found in CloudTrail, Unified Audit Logs, Windows Event Logs and `/var/log/auth.log` or `/var/log/secure` for Linux systems.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1021",
        mitreTechniqueName: "Remote Services",
        ciaMapping: ["C"],
        subTechniqueId: "T1021.008",
        subTechniqueName: "Direct Cloud VM Connections",
        mitreControlId: "M1042",
        mitreControlName: "Disable or Remove Feature or Program",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "If direct virtual machine connections are not required for administrative use, disable these connection types where feasible.",
        controlPriority: 2,
        bluOceanControlDescription:
          "If direct virtual machine connections are not required for administrative use, disable these connection types where feasible.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["IaaS"],
        mitreTechniqueId: "T1021",
        mitreTechniqueName: "Remote Services",
        ciaMapping: ["C"],
        subTechniqueId: "T1021.008",
        subTechniqueName: "Direct Cloud VM Connections",
        mitreControlId: "M1018",
        mitreControlName: "User Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Limit which users are allowed to access compute infrastructure via cloud native methods.",
        controlPriority: 5,
        bluOceanControlDescription:
          "Limit which users are allowed to access compute infrastructure via cloud native methods.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["SaaS"],
        mitreTechniqueId: "T1213",
        mitreTechniqueName: "Data from Information Repositories",
        ciaMapping: ["C"],
        subTechniqueId: "T1213.001",
        subTechniqueName: "Confluence",
        mitreControlId: "DS0015",
        mitreControlName: "Application Log Content",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for third-party application logging, messaging, and/or other artifacts that may leverage Confluence repositories to mine valuable information. Watch for access to Confluence repositories performed by privileged users (for example, Active Directory Domain, Enterprise, or Schema Administrators) as these types of accounts should generally not be used to access information repositories. If the capability exists, it may be of value to monitor and alert on users that are retrieving and viewing a large number of documents and pages; this behavior may be indicative of programmatic means being used to retrieve all data within the repository. In environments with high-maturity, it may be possible to leverage User-Behavioral Analytics (UBA) platforms to detect and alert on user based anomalies.",
        controlPriority: 9,
        bluOceanControlDescription:
          "Monitor for third-party application logging, messaging, and/or other artifacts that may leverage Confluence repositories to mine valuable information. Watch for access to Confluence repositories performed by privileged users (for example, Active Directory Domain, Enterprise, or Schema Administrators) as these types of accounts should generally not be used to access information repositories. If the capability exists, it may be of value to monitor and alert on users that are retrieving and viewing a large number of documents and pages; this behavior may be indicative of programmatic means being used to retrieve all data within the repository. In environments with high-maturity, it may be possible to leverage User-Behavioral Analytics (UBA) platforms to detect and alert on user based anomalies.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["SaaS"],
        mitreTechniqueId: "T1213",
        mitreTechniqueName: "Data from Information Repositories",
        ciaMapping: ["C"],
        subTechniqueId: "T1213.001",
        subTechniqueName: "Confluence",
        mitreControlId: "DS0028",
        mitreControlName: "Logon Session Creation",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for newly constructed logon behavior across Atlassian's Confluence which can be configured to report access to certain pages and documents through AccessLogFilter. (Citation: Atlassian Confluence Logging) Additional log storage and analysis infrastructure will likely be required for more robust detection capabilities.",
        controlPriority: 8,
        bluOceanControlDescription:
          "Monitor for newly constructed logon behavior across Atlassian's Confluence which can be configured to report access to certain pages and documents through AccessLogFilter. (Citation: Atlassian Confluence Logging) Additional log storage and analysis infrastructure will likely be required for more robust detection capabilities.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["SaaS"],
        mitreTechniqueId: "T1213",
        mitreTechniqueName: "Data from Information Repositories",
        ciaMapping: ["C"],
        subTechniqueId: "T1213.001",
        subTechniqueName: "Confluence",
        mitreControlId: "M1047",
        mitreControlName: "Audit",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Consider periodic review of accounts and privileges for critical and sensitive Confluence repositories.",
        controlPriority: 4,
        bluOceanControlDescription:
          "Consider periodic review of accounts and privileges for critical and sensitive Confluence repositories.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["SaaS"],
        mitreTechniqueId: "T1213",
        mitreTechniqueName: "Data from Information Repositories",
        ciaMapping: ["C"],
        subTechniqueId: "T1213.001",
        subTechniqueName: "Confluence",
        mitreControlId: "M1018",
        mitreControlName: "User Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Enforce the principle of least-privilege. Consider implementing access control mechanisms that include both authentication and authorization.",
        controlPriority: 5,
        bluOceanControlDescription:
          "Enforce the principle of least-privilege. Consider implementing access control mechanisms that include both authentication and authorization.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["SaaS"],
        mitreTechniqueId: "T1213",
        mitreTechniqueName: "Data from Information Repositories",
        ciaMapping: ["C"],
        subTechniqueId: "T1213.001",
        subTechniqueName: "Confluence",
        mitreControlId: "M1017",
        mitreControlName: "User Training",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Develop and publish policies that define acceptable information to be stored in Confluence repositories.",
        controlPriority: 10,
        bluOceanControlDescription:
          "Develop and publish policies that define acceptable information to be stored in Confluence repositories.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["SaaS"],
        mitreTechniqueId: "T1213",
        mitreTechniqueName: "Data from Information Repositories",
        ciaMapping: ["C"],
        subTechniqueId: "T1213.003",
        subTechniqueName: "Code Repositories",
        mitreControlId: "DS0015",
        mitreControlName: "Application Log Content",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for third-party application logging, messaging, and/or other artifacts that may leverage code repositories to collect valuable information. Monitor access to code repositories, especially performed by privileged users such as Active Directory Domain or Enterprise Administrators as these types of accounts should generally not be used to access code repositories. In environments with high-maturity, it may be possible to leverage User-Behavioral Analytics (UBA) platforms to detect and alert on user-based anomalies.",
        controlPriority: 9,
        bluOceanControlDescription:
          "Monitor for third-party application logging, messaging, and/or other artifacts that may leverage code repositories to collect valuable information. Monitor access to code repositories, especially performed by privileged users such as Active Directory Domain or Enterprise Administrators as these types of accounts should generally not be used to access code repositories. In environments with high-maturity, it may be possible to leverage User-Behavioral Analytics (UBA) platforms to detect and alert on user-based anomalies.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["SaaS"],
        mitreTechniqueId: "T1213",
        mitreTechniqueName: "Data from Information Repositories",
        ciaMapping: ["C"],
        subTechniqueId: "T1213.003",
        subTechniqueName: "Code Repositories",
        mitreControlId: "DS0028",
        mitreControlName: "Logon Session Creation",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for newly constructed logon behavior across code repositories (e.g. Github) which can be configured to report access to certain pages and documents.",
        controlPriority: 8,
        bluOceanControlDescription:
          "Monitor for newly constructed logon behavior across code repositories (e.g. Github) which can be configured to report access to certain pages and documents.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["SaaS"],
        mitreTechniqueId: "T1213",
        mitreTechniqueName: "Data from Information Repositories",
        ciaMapping: ["C"],
        subTechniqueId: "T1213.003",
        subTechniqueName: "Code Repositories",
        mitreControlId: "M1047",
        mitreControlName: "Audit",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Consider periodic reviews of accounts and privileges for critical and sensitive code repositories. Scan code repositories for exposed credentials or other sensitive information.",
        controlPriority: 4,
        bluOceanControlDescription:
          "Consider periodic reviews of accounts and privileges for critical and sensitive code repositories. Scan code repositories for exposed credentials or other sensitive information.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["SaaS"],
        mitreTechniqueId: "T1213",
        mitreTechniqueName: "Data from Information Repositories",
        ciaMapping: ["C"],
        subTechniqueId: "T1213.003",
        subTechniqueName: "Code Repositories",
        mitreControlId: "M1032",
        mitreControlName: "Multi-factor Authentication",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Use multi-factor authentication for logons to code repositories.",
        controlPriority: 1,
        bluOceanControlDescription:
          "Use multi-factor authentication for logons to code repositories.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["SaaS"],
        mitreTechniqueId: "T1213",
        mitreTechniqueName: "Data from Information Repositories",
        ciaMapping: ["C"],
        subTechniqueId: "T1213.003",
        subTechniqueName: "Code Repositories",
        mitreControlId: "M1018",
        mitreControlName: "User Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Enforce the principle of least-privilege. Consider implementing access control mechanisms that include both authentication and authorization for code repositories.",
        controlPriority: 5,
        bluOceanControlDescription:
          "Enforce the principle of least-privilege. Consider implementing access control mechanisms that include both authentication and authorization for code repositories.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["SaaS"],
        mitreTechniqueId: "T1213",
        mitreTechniqueName: "Data from Information Repositories",
        ciaMapping: ["C"],
        subTechniqueId: "T1213.003",
        subTechniqueName: "Code Repositories",
        mitreControlId: "M1017",
        mitreControlName: "User Training",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Develop and publish policies that define acceptable information to be stored in code repositories.",
        controlPriority: 10,
        bluOceanControlDescription:
          "Develop and publish policies that define acceptable information to be stored in code repositories.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1187",
        mitreTechniqueName: "Forced Authentication",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0022",
        mitreControlName: "File Access",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for unexpected files used to gather credentials when the files are rendered.",
        controlPriority: 2,
        bluOceanControlDescription:
          "Monitor for unexpected files used to gather credentials when the files are rendered.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1187",
        mitreTechniqueName: "Forced Authentication",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0022",
        mitreControlName: "File Creation",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for newly constructed .LNK, .SCF, or any other files on systems and within virtual environments that contain resources that point to external network resources",
        controlPriority: 2,
        bluOceanControlDescription:
          "Monitor for newly constructed files on systems and within virtual environments that contain resources that point to external network resources",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1187",
        mitreTechniqueName: "Forced Authentication",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0022",
        mitreControlName: "File Modification",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for changes made to the .LNK, .SCF, or any other files on systems and within virtual environments that contain resources that point to external network resources",
        controlPriority: 2,
        bluOceanControlDescription:
          "Monitor for changes made to files on systems and within virtual environments that contain resources that point to external network resources",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1187",
        mitreTechniqueName: "Forced Authentication",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0029",
        mitreControlName: "Network Traffic Content",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "For internal traffic, monitor the workstation-to-workstation unusual (vs. baseline) SMB traffic. For many networks there should not be any, but it depends on how systems on the network are configured and where resources are located.",
        controlPriority: 3,
        bluOceanControlDescription:
          "For internal traffic, monitor the workstation-to-workstation unusual (vs. baseline) SMB traffic.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1187",
        mitreTechniqueName: "Forced Authentication",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0029",
        mitreControlName: "Network Traffic Flow",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for SMB traffic on TCP ports 139, 445 and UDP port 137 and WebDAV traffic attempting to exit the network to unknown external systems.If attempts are detected, then investigate endpoint data sources to find the root cause.",
        controlPriority: 3,
        bluOceanControlDescription:
          "Monitor for SMB traffic attempting to exit the network to unknown external systems.If attempts are detected, then investigate endpoint data sources to find the root cause.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1187",
        mitreTechniqueName: "Forced Authentication",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "M1037",
        mitreControlName: "Filter Network Traffic",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Block SMB traffic from exiting an enterprise network with egress filtering or by blocking TCP ports 139, 445 and UDP port 137. Filter or block WebDAV protocol traffic from exiting the network. If access to external resources over SMB and WebDAV is necessary, then traffic should be tightly limited with allowlisting. (Citation: US-CERT SMB Security) (Citation: US-CERT APT Energy Oct 2017)",
        controlPriority: 3,
        bluOceanControlDescription:
          "Block SMB traffic from exiting an enterprise network with egress filtering or by blocking ports. If access to external resources is necessary, then traffic should be tightly limited with allowlisting.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1187",
        mitreTechniqueName: "Forced Authentication",
        ciaMapping: ["C"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "M1027",
        mitreControlName: "Password Policies",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Use strong passwords to increase the difficulty of credential hashes from being cracked if they are obtained.",
        controlPriority: 4,
        bluOceanControlDescription:
          "Use strong passwords to increase the difficulty of credential hashes from being cracked if they are obtained.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1556",
        mitreTechniqueName: "Modify Authentication Process",
        ciaMapping: ["C", "I"],
        subTechniqueId: "T1556.004",
        subTechniqueName: "Network Device Authentication",
        mitreControlId: "DS0022",
        mitreControlName: "File Modification",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for changes made to the checksum of the operating system file and verifying the image of the operating system in memory.(Citation: Cisco IOS Software Integrity Assurance - Image File Verification)(Citation: Cisco IOS Software Integrity Assurance - Run-Time Memory Verification) Detection of this behavior may be difficult, detection efforts may be focused on closely related adversary behaviors, such as Modify System Image.",
        controlPriority: 2,
        bluOceanControlDescription:
          "Monitor for changes made to the checksum of the operating system file and verifying the image of the operating system in memory.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1556",
        mitreTechniqueName: "Modify Authentication Process",
        ciaMapping: ["C", "I"],
        subTechniqueId: "T1556.004",
        subTechniqueName: "Network Device Authentication",
        mitreControlId: "M1032",
        mitreControlName: "Multi-factor Authentication",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Use multi-factor authentication for user and privileged accounts. Most embedded network devices support TACACS+ and/or RADIUS. Follow vendor prescribed best practices for hardening access control. (Citation: Cisco IOS Software Integrity Assurance - TACACS)",
        controlPriority: 1,
        bluOceanControlDescription:
          "Use multi-factor authentication for user and privileged accounts. Follow vendor prescribed best practices for hardening access control.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1556",
        mitreTechniqueName: "Modify Authentication Process",
        ciaMapping: ["C", "I"],
        subTechniqueId: "T1556.004",
        subTechniqueName: "Network Device Authentication",
        mitreControlId: "M1026",
        mitreControlName: "Privileged Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Restrict administrator accounts to as few individuals as possible, following least privilege principles. Prevent credential overlap across systems of administrator and privileged accounts, particularly between network and non-network platforms, such as servers or endpoints.",
        controlPriority: 10,
        bluOceanControlDescription:
          "Restrict administrator accounts to as few individuals as possible, following least privilege principles. Prevent credential overlap across systems of administrator and privileged accounts, particularly between network and non-network platforms, such as servers or endpoints.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1556",
        mitreTechniqueName: "Modify Authentication Process",
        ciaMapping: ["C", "I"],
        subTechniqueId: "T1556.005",
        subTechniqueName: "Reversible Encryption",
        mitreControlId: "DS0026",
        mitreControlName: "Active Directory Object Modification",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor property changes in Group Policy: <code>Computer Configuration\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Store passwords using reversible encryption</code>. By default, the property should be set to Disabled.",
        controlPriority: 5,
        bluOceanControlDescription:
          "Monitor property changes in Group Policy: <code>Computer Configuration\\Windows Settings\\Security Settings\\Account Policies\\Password Policy\\Store passwords using reversible encryption</code>. By default, the property should be set to Disabled.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1556",
        mitreTechniqueName: "Modify Authentication Process",
        ciaMapping: ["C", "I"],
        subTechniqueId: "T1556.005",
        subTechniqueName: "Reversible Encryption",
        mitreControlId: "DS0017",
        mitreControlName: "Command Execution",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor command-line usage for <code>-AllowReversiblePasswordEncryption $true</code> or other actions that could be related to malicious tampering of user settings (i.e. [Group Policy Modification](https://attack.mitre.org/techniques/T1484/001)).",
        controlPriority: 5,
        bluOceanControlDescription:
          "Monitor command-line usage for <code>-AllowReversiblePasswordEncryption $true</code> or other actions that could be related to malicious tampering of user settings",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1556",
        mitreTechniqueName: "Modify Authentication Process",
        ciaMapping: ["C", "I"],
        subTechniqueId: "T1556.005",
        subTechniqueName: "Reversible Encryption",
        mitreControlId: "DS0012",
        mitreControlName: "Script Execution",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Consider monitoring and/or blocking suspicious execution of Active Directory PowerShell modules, such as <code>Set-ADUser</code> and <code>Set-ADAccountControl</code>, that change account configurations.",
        controlPriority: 7,
        bluOceanControlDescription:
          "Monitor and/or block suspicious execution of Active Directory PowerShell modules that change account configurations",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1556",
        mitreTechniqueName: "Modify Authentication Process",
        ciaMapping: ["C", "I"],
        subTechniqueId: "T1556.005",
        subTechniqueName: "Reversible Encryption",
        mitreControlId: "DS0002",
        mitreControlName: "User Account Metadata",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor Fine-Grained Password Policies and regularly audit user accounts and group settings.(Citation: dump_pwd_dcsync)",
        controlPriority: 1,
        bluOceanControlDescription:
          "Monitor Fine-Grained Password Policies and regularly audit user accounts and group settings.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1556",
        mitreTechniqueName: "Modify Authentication Process",
        ciaMapping: ["C", "I"],
        subTechniqueId: "T1556.005",
        subTechniqueName: "Reversible Encryption",
        mitreControlId: "M1027",
        mitreControlName: "Password Policies",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Ensure that <code>AllowReversiblePasswordEncryption</code> property is set to disabled unless there are application requirements.(Citation: store_pwd_rev_enc)",
        controlPriority: 4,
        bluOceanControlDescription:
          "Ensure that <code>AllowReversiblePasswordEncryption</code> property is set to disabled unless there are application requirements.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["Windows"],
        mitreTechniqueId: "T1556",
        mitreTechniqueName: "Modify Authentication Process",
        ciaMapping: ["C", "I"],
        subTechniqueId: "T1556.005",
        subTechniqueName: "Reversible Encryption",
        mitreControlId: "M1026",
        mitreControlName: "Privileged Account Management",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Audit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account.(Citation: TechNet Credential Theft)(Citation: TechNet Least Privilege) These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.(Citation: Microsoft Securing Privileged Access)",
        controlPriority: 10,
        bluOceanControlDescription:
          "Audit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["macOS"],
        mitreTechniqueId: "T1647",
        mitreTechniqueName: "Plist File Modification",
        ciaMapping: ["C", "I"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0017",
        mitreControlName: "Command Execution",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for commands with arguments (such as opening common command-line editors) used to modify plist files, especially commonly abused files such as those in <code>\\~/LaunchAgents</code>, <code>\\~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm</code>, and an application's <code>Info.plist</code>.",
        controlPriority: 5,
        bluOceanControlDescription:
          "Monitor for commands with arguments (such as opening common command-line editors) used to modify plist files.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["macOS"],
        mitreTechniqueId: "T1647",
        mitreTechniqueName: "Plist File Modification",
        ciaMapping: ["C", "I"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0022",
        mitreControlName: "File Modification",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for plist file modification, especially if immediately followed by other suspicious events such as code execution from <code>\\~/Library/Scripts</code> or <code>\\~/Library/Preferences</code>. Also, monitor for significant changes to any path pointers in a modified plist.",
        controlPriority: 2,
        bluOceanControlDescription:
          "Monitor for plist file modification, especially if immediately followed by other suspicious events such as code execution and monitor for significant changes to any path pointers in a modified plist.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["macOS"],
        mitreTechniqueId: "T1647",
        mitreTechniqueName: "Plist File Modification",
        ciaMapping: ["C", "I"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "DS0009",
        mitreControlName: "Process Creation",
        mitreControlType: "DETECTION",
        mitreControlDescription:
          "Monitor for newly executed processes with arguments that can modify property list (plist) files.",
        controlPriority: 6,
        bluOceanControlDescription:
          "Monitor for newly executed processes with arguments that can modify property list (plist) files.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
      {
        platforms: ["macOS"],
        mitreTechniqueId: "T1647",
        mitreTechniqueName: "Plist File Modification",
        ciaMapping: ["C", "I"],
        subTechniqueId: "",
        subTechniqueName: "",
        mitreControlId: "M1013",
        mitreControlName: "Application Developer Guidance",
        mitreControlType: "MITIGATION",
        mitreControlDescription:
          "Ensure applications are using Apple's developer guidance which enables hardened runtime.(Citation: Apple Developer Doco Hardened Runtime)",
        controlPriority: 6,
        bluOceanControlDescription:
          "Ensure applications are using Apple's developer guidance which enables hardened runtime.",
        status: "published",
        created_at: now,
        updated_at: now,
      },
    ];

    const organization = await Organization.findOne({
      where: { name: "Demo Org 1" },
    });
    if (!organization || !organization.organizationId) {
      throw new Error("Organization not found");
    }
    const orgId = organization.organizationId;

    const updatedMitreThreatControlArray = mitreThreatsControls.map((item) => {
      const { created_at, updated_at, ...rest } = item;

      return {
        ...rest,
        createdDate: created_at,
        modifiedDate: updated_at,
        organizationId: orgId,
      };
    });

    await safeSeed(
      OrganizationThreat,
      updatedMitreThreatControlArray,
      "mitreTechniqueId",
      "subTechniqueId",
      "mitreControlId",
      "mitreControlName"
    );
  },

  async down() {
    await MitreThreatControl.destroy({ truncate: true, cascade: true });
  },
};
